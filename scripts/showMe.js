/*! -- File: showMe.js ( Input 0 ) -- */
function showMe(g){function h(){var a=b.carousel.find(".active img"),d=function(){e.trigger(z.READY,c)};a[0].complete?d():a[0].onload=function(){requestAnimationFrame(function(){requestAnimationFrame(d)})}}function m(a){var b=this.showMe.STRINGS.CONTINUE;if(!D||1==c.getCurrentSection()&&1==c.getCurrentStep())b=this.showMe.STRINGS.PLAY;N(a,v.WITH_CALLBACK,null,b,showMe.STRINGS.ARIA_LABEL_INTRODUCTION)}function p(){var a=c.getCurrentStep(),b=c.getCurrentSection();return t[b-1].numberOfSteps<=a&&t[b-
1].sectionType==O.BRANCH&&t[c.getCurrentSection()-1].steps[c.getCurrentStep()-1].eventType!=n.DECISION||b==t.length&&a==t[b-1].numberOfSteps?!0:!1}function Z(a){D=w=!1;c.pause();E();a?N(a,v.WITH_CALLBACK,function(){ja(!0);u.resetSections()},this.showMe.STRINGS.OK,showMe.STRINGS.ARIA_LABEL_SUMMARY):(c.goToStep(1,1),u.resetSections());b.playHeadButton.parent().removeClass("hidden")}function P(){b.previousButton.prop("disabled",!0)}function x(){b.forwardButton.prop("disabled",!0)}function aa(){b.previousButton.prop("disabled",
!1)}function ka(a,d){if(p())Z(a);else{var f=b.sectionInfo.data("number-of-sections"),B=c.getCurrentSection()+1,A=this.showMe.STRINGS.CONTINUE;B>f&&(A=this.showMe.STRINGS.OK);f=ja;d&&(f=d);N(a,v.WITH_CALLBACK,f,A,showMe.STRINGS.ARIA_LABEL_SUMMARY)}}function ja(a){if((1!=q.playerHead.getY()||1!=q.playerHead.getX())&&!l.isShowing()){var d=b.sectionInfo.data("number-of-sections"),f=c.getCurrentSection()+1;if(d>=f){if(!b.sectionInfo.find("#section-"+(c.getCurrentSection()+1)).data("section-introduction")){b.carousel.carousel("next");
a=c.getCurrentSection();b.sectionInfo.find("#section-"+a);Q();c.toggleActiveStep();ba();y();return}a||c.nextStep()}ba()}}function N(a,b,f,c,A){if(a){A=$("\x3cdiv class\x3d'general-container-text-package' aria-label\x3d'"+A+"'\x3e\x3c/div\x3e");var e=$("\x3cdiv class \x3d 'general-container-text-content'\x3e\x3c/div\x3e");e.html(a);H();a=$("\x3cdiv class\x3d'general-container-primary-action-button-div'\x3e\x3cbutton class\x3d'btn btn-primary'\x3e"+c+" \x3c/button\x3e\x3c/div\x3e");$(a).on("click",
function(){l.closePanel();f&&f()});A.append(e);A.append(a);l.addAndDisplayPanel(A,b)}}function R(a){b.inner.animate({top:0,left:0,scale:1},{duration:a,start:ca,step:da})}function ea(){var a=b.sideContainer.find(".panel"),d=b.sideContainer.find(".active").closest(".step-item-container");a.animate({scrollTop:d.position().top/la-a.position().top+a.scrollTop()});a=b.showMeContainer.find("#nextStep");d=b.showMeContainer.find("#prevStep");b.inner.find(".item:first").hasClass("active")?d.prop("disabled",
!0):d.prop("disabled",!1);b.inner.find(".item:last").hasClass("active")?a.prop("disabled",!0):a.prop("disabled",!1)}function S(){b.sideContainer.find(".panel").css("max-height",b.showMeContainer.height()+"px");var a=b.showMeContainer.find("#toggleZoom");1<=T()?a.hide():a.show()}function ba(){var a=b.sideContainer.find(".active").children(".label");a.data("time-start");a.parent().data("section-count");updateCurentTime();U(k.relativeCurrentTime);F()}function U(a,d){d?b.playBar.animate({width:a/k.globalDuration*
100+"%"},d,"linear"):b.playBar.css("width",a/k.globalDuration*100+"%");F()}function Ba(){U(k.relativeCurrentTime,1E3);F();I&&clearInterval(I);I=setInterval(function(){k.currentTime+=1E3;k.relativeCurrentTime+=1E3;U(k.relativeCurrentTime,1E3)},1E3)}function V(){b.playBar.stop();clearInterval(I)}function ma(a){var b=(new Date(parseInt(a,10))).toISOString();return 36E5>a?b.slice(14,-5):b.slice(11,-5)}function F(){k.globalDuration=u.getTotalActiveSectionsTime();b.showMeContainer.find(".player-time").text(ma(k.relativeCurrentTime)+
" / "+ma(k.globalDuration))}function Ca(a,b){na?fetch(a).then(function(a){a.blob().then(function(a){var b=new FileReader;b.addEventListener("loadend",function(){oa(b.result.toString())});b.readAsDataURL(a)})}):oa(a)}function oa(a){b.mouse.hide();if(null!=a){var d={};d.mp3=a;b.jplayer.jPlayer({ready:function(){Da(d)},supplied:"mp3",solution:"html",size:{height:"0px"}})}}function Da(a){a&&b.jplayer.jPlayer("setMedia",a);b.playHeadButton.on("click",y);b.playButton.on("click",y);b.carousel.on("click",
y);b.playButtonIcon.attr("class","fa fa-fw fa-play fa-2x");b.showMeContainer.find("#mute").click(function(){fa?(fa=!1,b.jplayer.jPlayer("unmute"),$(this).children("i").attr("class","fa fa-2x fa-fw fa-volume-up")):(fa=!0,b.jplayer.jPlayer("mute"),$(this).children("i").attr("class","fa fa-2x fa-fw fa-volume-off"))});l.isShowing()||c.goToStep(1,1)}function pa(a){a?b.jplayer.jPlayer("play",a):(b.jplayer.jPlayer("play"),r&&!r[c.getOverallStep()-1]&&E())}function E(){b.jplayer.jPlayer("pause")}function qa(a,
d){J().eventType==n.DECISION&&(P(),b.playButton.prop("disabled",!0),x(),V(),a=0);var f=b.carousel.find(".active"),f=$(f).data("click-count"),f=parseInt(f);W=1<f?Math.min(800+399*Math.min(f,3),a):Math.min(1200,a);K=setTimeout(function(){K=setTimeout(function(){var a=c.getCurrentSectionInfo(),b=c.getCurrentStep(),f=function(){if(a.data("section-size")==b){var d=a.data("section-summary"),f=J();if(d&&f.eventType!==n.DECISION){ka(d);return}}c.nextStep()};d?ra(d,f):f()},Math.min(W,a));sa(W)},Math.max(a-
W,0))}function ra(a,d){clearTimeout(L);var f=1E3*b.jplayer.data().jPlayer.status.currentTime,c=a-f;25>c||0==f?d():L=setTimeout(ra,c-25,a,d)}function J(){return t[c.getCurrentSection()-1].steps[c.getCurrentStep()-1]}function ta(a){return"#"+a.substring(a.indexOf("x")+1)}function Q(){return u.getStepStepDurationFromSectionAndStep(q.playerHead.getX(),q.playerHead.getY())}function ua(a){a?(b.showMeContainer.addClass("capture-fullscreen-height"),e.addClass("capture-fullscreen-overflow")):(b.showMeContainer.removeClass("capture-fullscreen-height"),
e.removeClass("capture-fullscreen-overflow"))}function T(){var a=c.getOverallStep?c.getOverallStep()-1:0;if(C!=captureProjectUtils.getfullscreenMode()){var d=captureProjectUtils.getfullscreenMode();ua(d);C=d}return captureProjectUtils.getScale(b,C,a)}function Ea(){var a=T();b.mouse.css("transform","scale("+a+") translate3d(0, 0, 0)");b.dragOverlay.css("transform","scale("+a+") translate3d("+-b.dragOverlay.width()/2+"px , "+-b.dragOverlay.height()/2+"px , 0)")}function ga(){this.carouselItem=b.carousel.find(".active");
this.index=this.carouselItem.index()+1;this.totalItems=e.find(".item").length;this.currentItem=e.find(".item").get(this.index);this.minX=this.carouselItem.data("hotspotMinx");this.minY=this.carouselItem.data("hotspotMiny");this.width=this.carouselItem.data("hotspotWidth");this.height=this.carouselItem.data("hotspotHeight");this.imageElement=b.carousel.find("img")[this.index-1];this.naturalWidth=this.imageElement.naturalWidth;this.naturalHeight=this.imageElement.naturalHeight;this.carouselWidth=this.carouselItem.width();
this.carouselHeight=this.carouselItem.height();this.currentEvent=b.carousel.find(".active").data("eventType");this.scale=T();this.offset=0;this.activeElement=b.carousel.find(".active");this.clickCountAttr=$(this.activeElement).data("click-count");this.dataClicks=parseInt(this.clickCountAttr)}function Fa(a,b){var f=a-399*Math.min(b.dataClicks,3);b.currentEvent===n.SELECT&&(f=a/6);return f}function sa(a){var d=new ga;if(d.index<=d.totalItems){var f=function(){if(d.currentEvent===n.SELECT){var f=d.carouselItem.find("select").css("overflow",
"hidden"),c=f.find("option"),B=c.filter(".correct");f[0].size=c.length;b.mouse.animate({top:e+(B.position().top-d.height)*(1/d.scale)},a/4,function(){B.attr("selected",!0);setTimeout(function(){f[0].size=0;b.mouse.find(".mouse-pointer").show();b.mouse.find(".mouse-pointer-click").hide()},a/4)})}else if(d.currentEvent==n.DRAG_START||d.currentEvent==n.DRAG_FINISH&&X==n.DRAG_START||!a)d.currentEvent==n.DRAG_START||d.currentEvent==n.DRAG_FINISH&&X==n.DRAG_START||(b.mouse.find(".mouse-pointer").show(),
b.mouse.find(".mouse-pointer-click").hide());else if(2==d.dataClicks|!d.dataClicks)for(c=d.dataClicks;0<c;)setTimeout(function(){b.mouse.find(".mouse-pointer").show();b.mouse.find(".mouse-pointer-click").hide()},133),setTimeout(function(){b.mouse.find(".mouse-pointer").hide();b.mouse.find(".mouse-pointer-click").show()},266),setTimeout(function(){b.mouse.find(".mouse-pointer").show();b.mouse.find(".mouse-pointer-click").hide()},399),c--;else if(2<d.dataClicks|!d.dataClicks)for(c=d.dataClicks-1;0<
c;)setTimeout(function(){b.mouse.find(".mouse-pointer").show();b.mouse.find(".mouse-pointer-click").hide()},133*c),setTimeout(function(){b.mouse.find(".mouse-pointer").hide();b.mouse.find(".mouse-pointer-click").show()},266*c),setTimeout(function(){b.mouse.find(".mouse-pointer").show();b.mouse.find(".mouse-pointer-click").hide()},399*c),c--;else setTimeout(function(){b.mouse.find(".mouse-pointer").show();b.mouse.find(".mouse-pointer-click").hide()},399)};d.carouselWidth>d.naturalWidth&&(d.offset=
(d.carouselWidth-d.naturalWidth)/2);var c=(parseInt(d.minX)+parseInt(d.width)/2)*d.scale+d.offset,e=(parseInt(d.minY)+parseInt(d.height)/2)*d.scale;0<d.width&&b.mouse.animate({left:c,top:e},Fa(a,d),function(){b.mouse.find(".mouse-pointer").hide();b.mouse.find(".mouse-pointer-click").show();f();X=d.currentEvent});Ea();M&&(1<=d.scale?b.inner.animate({top:0,left:0,scale:1},{start:ca,step:da,duration:a}):va());width=parseInt(d.width);height=parseInt(d.height);d.currentEvent==n.DRAG_START?(b.dragOverlay.width(d.width),
b.dragOverlay.height(d.height),b.dragOverlay.css("top",e).css("left",c)):d.currentEvent==n.DRAG_FINISH&&X==n.DRAG_START&&(b.dragOverlay.show(),b.mouse.find(".mouse-pointer").hide(),b.mouse.find(".mouse-pointer-click").show(),b.dragOverlay.animate({left:c,top:e},parseInt(a),function(){b.dragOverlay.hide();b.mouse.find(".mouse-pointer").show();b.mouse.find(".mouse-pointer-click").hide()}))}else R(400)}function H(){b.playHeadButton.parent().addClass("hidden")}function y(){if(w)wa();else{D||(D=!0,c.goToStep(1,
1));if(!Y){b.playButtonIcon.attr("class","fa fa-fw fa-pause fa-2x");H();pa();var a;0!=G?(a=G,G=0):a=u.getStepStepDurationFromSectionAndStep(q.playerHead.getX(),q.playerHead.getY());Ba();var d=null;r&&r[c.getOverallStep()-1]&&(d=r[c.getOverallStep()-1][1]);qa(a,d);b.mouse.show();e.trigger(z.PLAY,c)}b.playButton.focus()}w=!w}function wa(){b.playButtonIcon.attr("class","fa fa-fw fa-play fa-2x");E();clearTimeout(K);clearTimeout(L);b.jplayer.data("jPlayer");var a=k.currentTime,d=Q(),f=parseInt(b.carousel.find(".active").attr("data-start-time"),
10),B=0;try{if(1<c.getCurrentSection())for(var A=b.sectionInfo.children(),g=0;g<c.getCurrentSection()-1;g++)B+=$(A[g]).data("section-duration")}catch(h){}G=f+B+parseInt(d,10)-a;V();e.trigger(z.PAUSE,c)}function Ga(a){var b={};window.location.href.replace(location.hash,"").replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(a,c,e){b[c]=void 0!==e?e:""});return a?b[a]?b[a]:null:decodeURI(b)}var W=0,n={DRAG_START:"START_MOUSE_DRAGGED",DRAG_FINISH:"FINISH_MOUSE_DRAGGED",SELECT:"SELECT",DECISION:"DECISION",STOP:"CAPTURE_STOP"},
O={SECTION:"SECTION",BRANCH:"BRANCH",ALTERNATIVE_PATH:"ALTERNATIVE_PATH"},v={BASIC:{priority:0},WITH_CALLBACK:{priority:2},FROM_STEP:{priority:1}},z={PLAY:"showMe.play",PAUSE:"showMe.pause",STEP_CHANGED:"showMe.stepChanged",ENDED:"showMe.ended",READY:"showMe.ready"};showMe.STRINGS={PLAY:"Play",OK:"OK",CONTINUE:"Continue",ARIA_LABEL_DECISION:"Decision step frame",ARIA_LABEL_DECISION_INSTRUCTION:"Decision step instructions",ARIA_LABEL_DECISION_OPTIONS:"Decision step options",ARIA_LABEL_INTRODUCTION:"Scene Introduction",
ARIA_LABEL_SUMMARY:"Scene summary",ARIA_LABEL_GLOSSARY:"Glossary definition"};showMe.STRINGS=$.extend({},showMe.STRINGS,g.STRINGS);var K,L,X,w=!1,G=0,D=!1,M=!0,Y=!1,C=!1,fa=!1,xa=1,t,la=1,ha,ya,r,e,b,za,I,na=!0,Aa={},ia,c={},l={currentPanels:Array(3),currentActivePanel:new TwoDimensionalPosition,pauseTriggered:!1},u=new SectionManager,q={introductionPanelShowing:!1,playerHead:new TwoDimensionalPosition,decisionTransition:!1},k={relativeCurrentTime:0,currentTime:0,globalDuration:0};(function(a){t=
a.sections;ha=a.fileName;ya=a.m4aTag;r=a.audioSprite;M=a.panAndZoom;"undefined"!==typeof a.performAudioFetch&&(na=a.performAudioFetch);"undefined"!==typeof a.uaSniffer&&(Aa=a.uaSniffer);a.transformScale&&(la=a.transformScale);ia=null==a.controlsListenerElement?a.container:a.controlsListenerElement;e=a.container;b={sectionInfo:e.find("#sectionInfo"),carousel:e.find("#softwareSimCarousel"),inner:e.find(".carousel-inner"),sideContainer:e.find("#stepsSideContainer"),showMeContainer:e.find("#showMeContainer"),
playHeadButton:e.find(".play-head-button"),playButtonIcon:e.find("#playButton .fa"),playButton:e.find("#playButton"),playBar:e.find(".bar"),mouse:e.find("#mouse"),dragOverlay:e.find("#showMeDragOverlay"),jplayer:e.find("#jplayer"),forwardButton:e.find("#nextStep"),previousButton:e.find("#prevStep"),GenericPanelOverlay:e.find("#generalPanelOverlay"),GenericPanelContentContainer:e.find("#generalPanelContentContainer")};b.inner.find(".item:first").addClass("active");b.sideContainer.find(".item:first").addClass("active");
k.globalDuration=e.data("duration");q.playerHead.set(1,1);ha?Ca(ya,ha):(b.playHeadButton.on("click",y),b.playButton.on("click",y),b.carousel.on("click",y),b.showMeContainer.find("#mute").remove(),b.playButtonIcon.attr("class","fa fa-fw fa-play fa-2x"));$.each($("img.unloaded"),function(){$(this).attr("src",$(this).data("src"));$(this).removeClass("unloaded")});$(document).ready(function(){b.carousel.on("contextmenu",function(b){b.preventDefault()})});F();b.mouse.hide();b.dragOverlay.hide();b.sideContainer.on("click",
".step-item",function(){c.goToStep($(this).data("section-count"),$(this).data("step-count"));H()});b.showMeContainer.on("click","#hideSteps",function(){c.toggleSteps()});b.showMeContainer.on("click","#fullScreen",function(){c.toggleFullscreen()});b.showMeContainer.on("click","#nextStep",function(){var a=c.getCurrentSection(),d=c.getCurrentStep(),e=b.sectionInfo.find("#section-"+a).data("section-size");b.sectionInfo.data("number-of-sections");d+1>e?c.goToStep(a+1,1):c.goToStep(a,d+1);H()});b.showMeContainer.on("click",
"#prevStep",function(){var a=c.getCurrentSection(),d=c.getCurrentStep();b.sectionInfo.find("#section-"+a).data("section-size");b.sectionInfo.data("number-of-sections");if(1>d-1){for(var d=0,e=!1;!e;a--)d=b.sectionInfo.find("#section-"+(a-1)).data("section-size"),null!=d?e=!0:1==a&&(e=!0);c.goToStep(a,d)}else c.goToStep(a,d-1);H()});ia.on("keydown",function(a){if(dkiUA.isIE()){if(32===a.originalEvent.keyCode)return a.preventDefault(),b.playButton.prop("disabled")||b.playButton.trigger("click"),!1}else if(" "===
a.key)return a.preventDefault(),b.playButton.prop("disabled")||b.playButton.trigger("click"),!1});ia.on("keyup",function(a){if(dkiUA.isIE()){if(39===a.originalEvent.keyCode)return b.forwardButton.prop("disabled")||b.forwardButton.trigger("click"),!1;if(37===a.originalEvent.keyCode)return b.previousButton.prop("disabled")||b.previousButton.trigger("click"),!1}else{if("ArrowRight"===a.key)return b.forwardButton.prop("disabled")||b.forwardButton.trigger("click"),!1;if("ArrowLeft"===a.key)return b.previousButton.prop("disabled")||
b.previousButton.trigger("click"),!1}});b.showMeContainer.on("click","#toggleZoom",function(){if(M){var a=$(this);b.inner.stop();M=!1;a.find(".fa").attr("class","fa fa-2x fa-fw fa-search-plus");a.prop("disabled",!0);R(300);setTimeout(function(){b.mouse.css("transform","scale(1) translate3d(0, 0, 0)");b.dragOverlay.css("transform","scale(1) translate3d(-50%, -50%, 0)");a.prop("disabled",!1)},300)}else M=!0,va(),$(this).find(".fa").attr("class","fa fa-2x fa-fw fa-search-minus")});if(Aa.safari){var d=
function(a){a[0]&&a.addClass("blurFix")};d(b.carousel.find(".active img:not(.blurFix)"));b.carousel.on("slide.bs.carousel",function(a){d($(a.relatedTarget).find("img:not(.blurFix)"))})}S();za=setInterval(S,1E3);1==Ga("hideSteps")&&(b.sideContainer.remove(),b.showMeContainer.css("width","100%"));R(0);e.on(z.STEP_CHANGED,function(){b.carousel.find(".item.active[data-event-type\x3d'STOP_CAPTURE']")[0]&&e.trigger(z.ENDED,c)});$(window).on("resize."+e.attr("id"),S);P();l.initialize=function(){this.currentPanels[0]=
[];this.currentPanels[1]=[];this.currentPanels[2]=[];this.panelOverlay=b.GenericPanelOverlay;this.panelContentContainer=b.GenericPanelContentContainer;this.currentlyShowingPanel=!1};l.showPanel=function(){this.panelOverlay.removeClass("hide-general-panel");this.currentlyShowingPanel=!0};l.hidePanel=function(){this.panelOverlay.addClass("hide-general-panel");this.currentlyShowingPanel=!1};l.addPanelToQue=function(a,b){this.currentPanels[b].push(a)};l.addContentToPanel=function(a){this.clearContentFromPanel();
a=a.clone(!0);this.panelContentContainer.append(a)};l.clearContentFromPanel=function(){this.panelContentContainer.empty()};l.pause=function(){this.pauseTriggered=!0;wa();w=!0;P();b.playButton.prop("disabled",!0);x();Y=!0};l.unpause=function(){this.pauseTriggered&&(Y=this.pauseTriggered=!1,aa(),b.playButton.prop("disabled",!1),b.forwardButton.prop("disabled",!1),w=!1,y())};l.displayPanels=function(){0<this.currentPanels[0].length?(this.pause(),this.currentActivePanel.set(0,0),this.addContentToPanel(this.currentPanels[0][0]),
this.showPanel()):0<this.currentPanels[1].length?(this.pause(),this.currentActivePanel.set(1,0),this.addContentToPanel(this.currentPanels[1][0]),this.showPanel()):0<this.currentPanels[2].length?(this.pause(),this.currentActivePanel.set(2,0),this.addContentToPanel(this.currentPanels[2][0]),this.showPanel()):this.unpause()};l.addAndDisplayPanel=function(a,b){switch(b){case v.BASIC:this.addPanelToQue(a,v.BASIC.priority);this.displayPanels();break;case v.WITH_CALLBACK:this.addPanelToQue(a,v.WITH_CALLBACK.priority);
this.displayPanels();break;case v.FROM_STEP:this.addPanelToQue(a,v.FROM_STEP.priority),this.displayPanels()}};l.deleteActivePanel=function(){this.currentActivePanel.isValid()&&this.currentPanels[this.currentActivePanel.getX()].splice(this.currentActivePanel.getY());this.currentActivePanel.reset();this.displayPanels()};l.closePanel=function(){this.hidePanel();this.deleteActivePanel()};l.isShowing=function(){return this.currentlyShowingPanel};l.initialize();u.initSectionManager(t,b.sideContainer);e.on(z.STEP_CHANGED,
function(a,b){q.playerHead.getX()!==b.x&&u.showSection(b.x);q.playerHead.set(b.x,b.y);q.decisionTransition=!1});e.one(z.READY,function(){m(b.sectionInfo.find("#section-1").data("section-introduction"))});h()})(g);c.destroy=function(){$(window).off("resize."+e.attr("id"));$.each(b,function(){$(this).off()});b=b.jplayer=null;clearInterval(za);clearInterval(I);clearTimeout(K);clearTimeout(L)};c.getOverallStep=function(){var a=c.getCurrentStep(),d=c.getCurrentSection(),f;for(f=1;f<d;f++){var e=b.sectionInfo.find("#section-"+
f).data("section-size");null!=e&&(a+=e)}return a};c.getCurrentStep=function(){return b.carousel.find(".active").data("stepCount")};c.getCurrentSection=function(){return b.carousel.find(".active").data("sectionCount")};c.getNumberOfSections=function(){return b.sectionInfo.data("number-of-sections")};c.toggleActiveStep=function(){b.showMeContainer.find(".item.active .targetHotspot").remove();b.sideContainer.find(".active").attr("class","list-group-item step-item");b.sideContainer.find("[data-step-count\x3d'"+
c.getCurrentStep()+"'][data-section-count\x3d'"+c.getCurrentSection()+"']").attr("class","list-group-item step-item active");currentActive=b.sideContainer.find(".active");b.sideContainer.find(".narration-text").addClass("hidden");currentActive.find(".narration-text").hasClass("hidden")&&currentActive.find(".narration-text").removeClass("hidden");b.sideContainer.find(".markerList").addClass("hidden");currentActive.find(".markerList").hasClass("hidden")&&currentActive.find(".markerList").removeClass("hidden");
var a=new ga;if(a.currentEvent===n.SELECT){for(var d=J(),f='\x3cdiv class\x3d"targetHotspot"\x3e\x3cselect\x3e',e=0;e<d.options.length;e++)f+="\x3coption value\x3d'"+d.options[e]+"'"+(d.initialSelection===d.options[e]?"selected":"")+' class\x3d"'+(d.options[e]===d.correct?"correct":"")+'"\x3e'+d.options[e]+"\x3c/option\x3e";f=$(f+"\x3c/select\x3e\x3c/div\x3e");b.showMeContainer.find(".item.active").append(f);f.css({top:a.minY*a.scale,left:a.minX*a.scale,"z-index":1E3,display:"block"});a=d.fontInfo;
null!=a&&a.useCustomTheme&&(null!=a.backgroundColor&&f.css({"background-color":ta(a.backgroundColor)}),null!=a.textFillColor&&f.css({color:ta(a.textFillColor)}),null!=a.fontSize&&f.css({"font-size":a.fontSize.split(" ").join("")}),null!=a.fontType&&f.css({"font-family":a.fontType}))}};c.getCurrentSectionInfo=function(){var a=c.getCurrentSection();return b.sectionInfo.find("#section-"+a)};c.nextStep=function(){E();if(p())Z(null);else if(J().eventType===n.DECISION){var a=null,d=c.getCurrentSectionInfo();
(d=d.data("section-summary"))&&(a=d);c.handleDecisionFrame(J(),a)}else{var f=c.getCurrentSection();b.carousel.carousel("next");a=c.getCurrentSection();if(f!=a){f=!1;for(--a;a<t.length;a++)if(t[a].sectionType!==O.ALTERNATIVE_PATH&&(t[a].sectionType!==O.BRANCH||t[a].sectionType===O.BRANCH&&q.decisionTransition)){c.goToStep(a+1,1,!0);f=!0;break}f||Z(d)}else{d=b.sectionInfo.find("#section-"+a);Q();c.toggleActiveStep();if(1==c.getCurrentStep()&&(d=d.data("section-introduction"))){ea();e.trigger(z.STEP_CHANGED,
c);F();m(d);return}d=!1;e.find(".carousel-inner .item:first").hasClass("active")?(b.playButtonIcon.attr("class","fa fa-fw fa-play fa-2x"),w=!1,G=0,updateCurentTime(),V(),U(0),b.playHeadButton.parent().removeClass("hidden"),b.mouse.hide()):d=!0;ea();a={y:c.getCurrentStep(),x:c.getCurrentSection()};e.trigger(z.STEP_CHANGED,a);a=null;r&&(r[c.getOverallStep()-1]?w&&(a=r[c.getOverallStep()-1][1],pa(r[c.getOverallStep()-1][0]/1E3)):E());d&&qa(u.getStepStepDurationFromSectionAndStep(q.playerHead.getX(),
q.playerHead.getY()),a);F();p()&&x()}}};c.goToOverallStep=function(a){var d=1,f,e=!1;for(f=1;!e;f++){var g=b.sectionInfo.find("#section-"+f).data("section-size");null!=g&&(g>=a?e=!0:(d++,a-=g))}c.goToStep(d,a)};c.decisionHandlers=[];c.handleDecisionFrame=function(a,b){var f=a.branchItems,e=$("\x3cdiv class\x3d'general-container-decision-package' aria-label\x3d'"+showMe.STRINGS.ARIA_LABEL_DECISION+"'\x3e\x3c/div\x3e"),g=$("\x3cdiv class \x3d 'general-container-decision-text-content' aria-label\x3d'"+
showMe.STRINGS.ARIA_LABEL_DECISION_INSTRUCTION+"'\x3e\x3c/div\x3e");e.append(g);var h=$("\x3cul aria-label\x3d'"+showMe.STRINGS.ARIA_LABEL_DECISION_OPTIONS+"'\x3e\x3c/ul\x3e");g.html(a.instructionalText);$.each(f,function(a,f){a=$('\x3cli class\x3d"decisionFrameChoice" id\x3ddecisionOption-section-'+f.sectionToJumpTo+'\x3e\x3ca class\x3d"btn btn-link" href\x3d"#"\x3e'+f.name+"\x3c/a\x3e\x3c/li\x3e");h.append(a);a.on("click",function(a){a=function(){c.goToStep(f.sectionToJumpTo+1,1,!0)};b?ka(b,a):
a();l.closePanel()});c.decisionHandlers.push(a)});e.append(h);l.addAndDisplayPanel(e,v.FROM_STEP)};c.goToStep=function(a,d,f,g){Y&&l.closePanel();var h=!1;p()&&(h=!0);w=!1;b.playButtonIcon.attr("class","fa fa-fw fa-play fa-2x");b.mouse.stop();clearTimeout(K);clearTimeout(L);b.dragOverlay.hide();if(1==a&&1<d||1<a)b.carousel.carousel(c.carouselStepNumber(a,d-1)),sa(0),b.mouse.show(),D=!0;else{var k=e.find("img")[0];b.mouse.animate({left:b.carousel.position().left+Math.max((b.carousel.width()-k.width)/
2,0),top:b.carousel.position().top+Math.max((b.carousel.height()-k.height)/2,0)},0);b.mouse.hide()}k=!1;if(g||a!=c.getCurrentSection())k=!0;b.carousel.carousel(c.carouselStepNumber(a,d));g=b.carousel.find(".active").data("startTime");c.toggleActiveStep();G=0;var n=b.jplayer.data("jPlayer");n&&n.status&&(r?(g=c.getOverallStep(),r[g-1]?b.jplayer.jPlayer("pause",r[g-1][0]/1E3):E()):b.jplayer.jPlayer("pause",g/1E3));ea();V();aa();b.playButton.prop("disabled",!1);b.forwardButton.prop("disabled",!1);1==
a&&1==d?P():aa();p()&&x();g=!1;if(k||h)if(h=b.sectionInfo.find("#section-"+a).data("section-introduction"))g=!0,1==a&&1==d&&(D=!1),a=new TwoDimensionalPosition,a.set(c.getCurrentSection(),c.getCurrentStep()),updateCurentTime(null,a),m(h);a={y:c.getCurrentStep(),x:c.getCurrentSection()};e.trigger(z.STEP_CHANGED,a);!g&&f&&c.play();ba()};c.carouselStepNumber=function(a,d){if(1==a)return d-1;var c=0,e;for(e=1;e<a;e++){var g=b.sectionInfo.find("#section-"+e).data("section-size");null!=g&&(c+=g)}return c+
d-1};updateCurentTime=function(a,b){a?(k.currentTime=a,k.relativeCurrentTime=a):b?(k.currentTime=u.calculateSeekStartTime(b),k.relativeCurrentTime=u.calculateCurrentTotalPlayTime(b)):(k.currentTime=u.calculateSeekStartTime(q.playerHead),k.relativeCurrentTime=u.calculateCurrentTotalPlayTime(q.playerHead))};var da=function(a,b){"scale"===b.prop&&($(this).css("transform","scale("+a+") translate3d(0, 0, 0)"),$(this).css("-webkit-transform","scale("+a+") translate3d(0, 0, 0)"),$(this).css("-moz-transform",
"scale("+a+") translate3d(0, 0, 0)"))},ca=function(a){for(var b=0;b<a.tweens.length;b++){var c=a.tweens[b];"scale"===c.prop&&0==c.start&&(c.start=xa,xa=c.end)}},va=function(){var a=new ga;duration=Q()/4;a.carouselWidth>a.naturalWidth&&(a.offset=(a.carouselWidth-a.naturalWidth)/2);var c=(parseInt(a.minX)+parseInt(a.width)/2)*a.scale+a.offset,e=(parseInt(a.minY)+parseInt(a.height)/2)*a.scale;b.inner.animate({top:-Math.min(Math.max(0,e/a.scale-a.carouselHeight/2),a.naturalHeight-a.carouselHeight),left:-Math.min(Math.max(0,
c/a.scale-a.carouselWidth/2),a.naturalWidth-a.carouselWidth),scale:1/a.scale},{start:ca,step:da,duration:duration})};c.toggleSteps=function(){b.sideContainer.is(":visible")?(b.sideContainer.fadeOut(300),setTimeout(function(){b.showMeContainer.addClass("full");b.showMeContainer.addClass("transition")},300)):(b.showMeContainer.removeClass("full"),setTimeout(function(){b.sideContainer.fadeIn();b.showMeContainer.removeClass("transition");S()},500))};c.toggleFullscreen=function(){captureProjectUtils.toggleFullscreen(e,
b,T(),function(a){C=a;ua(C);C&&(b.inner.stop(),R(300),C?$(".capture-image").css("max-height",screen.availHeight-$(".row.controls").height()-parseInt($(".bottom-buffer").css("margin-top").split("px")[0],10)):$(".capture-image").css("max-height",""))})};c.play=function(){w||y()};c.pause=function(){w&&y()};c.togglePlayback=function(){y()};c.reset=function(){c.goToStep(1,1,null,!0)};c.showGlossaryPane=function(a){a&&N(a,v.BASIC,null,showMe.STRINGS.CONTINUE,showMe.STRINGS.ARIA_LABEL_GLOSSARY)};return c}
var TwoDimensionalPosition=function(){this.y=this.x=-1;this.set=function(g,h){this.x=g;this.y=h};this.reset=function(){this.set(-1,-1)};this.isValid=function(){return-1!==this.x&&-1!==this.y};this.getX=function(){return this.x};this.getY=function(){return this.y}},Step=function(){this.duration=0;this.played=!1;this.element=null;this.init=function(g,h){this.element=h;this.duration=$(this.element).find("span.label").data("duration")}},SectionContainer=function(){this.sectionLengthinMillis=0;this.steps=
[];this.titleElement=this.element=null;this.type="";this.hidden=this.defaultHidden=!1;this.init=function(g,h){this.element=h;this.titleElement=$(h).find(".section-header");if(this.defaultHidden=$(this.element).hasClass("alternative-section"))this.hidden=!0;var m=$(h).find(".step-item-container"),p=this;$.each(g.steps,function(g,h){var x=new Step;x.init(h,m[g]);p.sectionLengthinMillis+=Number(x.duration);p.steps.push(x)})};this.hideSection=function(){$(this.element).addClass("hidden-section");$(this.element).removeClass("show-for-alternative");
this.hidden=!0};this.showSection=function(){$(this.element).addClass("show-for-alternative");this.hidden=!1};this.resetSection=function(){$(this.element).removeClass("show-for-alternative");$(this.element).removeClass("hidden-section");this.hidden=this.defaultHidden};this.getTimeIfActive=function(){return this.hidden?0:this.sectionLengthinMillis};this.getSectionLength=function(){return this.sectionLengthinMillis};this.getStepDuration=function(g){if(g)return this.steps[g-1].duration};this.getSectionLengthUpToStep=
function(g){for(var h=0,m=1;m<g;m++)h+=Number(this.getStepDuration(m));return h}},SectionManager=function(){this.sections=[];this.UIelement=null;this.initSectionManager=function(g,h){var m=this;this.UIelement=h;var p=this.UIelement.find(".side-container-section");$.each(g,function(g,h){var x=new SectionContainer;x.init(h,p[g]);m.sections.push(x)})};this.getStepStepDurationFromSectionAndStep=function(g,h){return this.sections[g-1].getStepDuration(h)};this.getTotalActiveSectionsTime=function(){var g=
0;$.each(this.sections,function(h,m){g+=m.getTimeIfActive()});return g};this.showSection=function(g){this.sections.length>=g&&this.sections[g-1].showSection()};this.calculateCurrentTotalPlayTime=function(g){var h=0;$.each(this.sections,function(m,p){m<g.getX()-1&&(h+=p.getTimeIfActive());m==g.getX()-1&&(h+=p.getSectionLengthUpToStep(g.getY()))});return h};this.calculateSeekStartTime=function(g){var h=0;$.each(this.sections,function(m,p){m<g.getX()-1&&(h+=p.getSectionLength());m==g.getX()-1&&(h+=p.getSectionLengthUpToStep(g.getY()))});
return h};this.resetSections=function(){$.each(this.sections,function(g,h){h.resetSection()})}};