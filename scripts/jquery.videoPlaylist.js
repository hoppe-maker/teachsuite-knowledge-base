/*! -- File: jquery.videoPlaylist.js ( Input 0 ) -- */
!function(c){var b=function(a,g){this.completion=g.completion||{};this.options=g;this.parent=this.options.parentSelector?c(c(a).closest(this.options.parentSelector)):c(a).parent();this.container=c(a);this.outline=g.outline;this.state={runningVideo:null};this.lookup=this.outline.elements.reduce(function(a,b){a[b.id]=b;return a},{});c(a).addClass("dki-videoplaylist");this.sizeVideo=DKI.func.debounce(c.proxy(function(){if(!this.options.responsive)return!1;var a=this.container.find(".vidWrapper"),b=.5625*
a.width(),g=this;this.container.height("auto");this.container.find(".menu").height(0);setTimeout(function(){g.container.height(g.container.height());g.container.find(".menu").css("height","")},1);a.height(b-30)},this),50,!1);switch(g.type){case "youtubeEmbed":this.interface=b.youtubeVideo;break;case "vimeoEmbed":this.interface=b.vimeoVideo;break;case "videoAsset":this.interface=b.assetVideo}this.initHandlers();this.render();this.initCompletion();this.sizeVideo();return this};b.DEFAULTS={completion:!1,
autoPlay:!0,showTime:!0,responsive:!1,collapsed:!1,dragInteract:!1,listeners:{start:function(){},play:function(){},pause:function(){},end:function(){},videoLoaded:function(){}}};b.prototype={render:function(){c.fn.RadialGauge&&this.options.showTime&&(this.container.find(".gauge").RadialGauge({parentSelector:".completion",ringSize:.25,fontRatio:1.5,current:function(){return 0}}),this.container.find(".gauge").RadialGauge("resize",50).RadialGauge("setRotation",100))},initHandlers:function(){var a=this;
if(this.options.dragInteract)this.container.on("dragenter.dkivp",function(b){a.container.addClass("drop");a.container.find(".dragD").one("dragleave drop",function(b){a.container.removeClass("drop")});return!1});a.container.parents().filter(function(){return c(this).is(".dki-authoring-section, .dki-authoring-row, .dki-authoring-group, .dki-authoring-element")}).each(function(b,d){(new MutationObserver(function(b){b.forEach(function(b){"attributes"===b.type&&"class"===b.attributeName&&c(d).hasClass("hidden")&&
DKI.isDefined(a.videoInterface)&&(a.videoInterface.pause(),a.paused.call(a),a.videoInterface.isPlaying=!1)})})).observe(d,{attributes:!0,attributeFilter:["class"]})});this.container.on("click.dkivp",".menu li:not(.active)",function(b,d){a.loadVideo(c(this).index(),"undefined"!==typeof d?d:!0);c(this).siblings().removeClass("active");c(this).addClass("active");return!1});this.container.on("click.dkivp",".menu li.active",function(b,d){b=a.outline.elements[c(this).index()];a.videoInterface&&a.videoInterface.outline.id==
b.id&&(a.videoInterface.isPlaying?(a.videoInterface.pause(),a.paused.call(a),a.videoInterface.isPlaying=!1):(a.videoInterface.play(),a.played.call(a),a.videoInterface.isPlaying=!0));return!1});this.container.on("change.dkivp",".tgl-light",function(b,d){a.options.autoPlay=c(this).checked();return!0});this.container.on("click.dvkivp",".vp-collapse",function(){a.toggleMenu()});this.container.on("click.dkivp",".menu li .skipToContent",function(b,c){a.videoInterface&&a.videoInterface.focusVideo();return!1});
this.container.on("click.dkivp",".skipToMenu",function(b,c){b=a.container.find(".menu li.active");b[0]&&b[0].focus();return!1});if(this.options.responsive)c(window).on("resize",this.sizeVideo)},loadVideo:function(a,b){a=this.outline.elements[a];var d=this;this.videoInterface||(this.videoInterface=new this.interface(a,this.container,{listeners:{start:c.proxy(this.started,this),end:c.proxy(this.ended,this),play:c.proxy(this.played,this),pause:c.proxy(this.paused,this),timeUpdate:c.proxy(this.timeUpdate,
this)},playList:this}));this.videoInterface.load(a,b,function(){d.options.listeners.videoLoaded.call(d)},this.completion[a.id]);this.container.find(".videoContainer h3 .vidTitle").html(a.title).attr("title",a.title);this.container.find(".skipToMenu").attr("tabindex",1);this.sizeVideo()},setCompletion:function(a,b,c){var e=b.find(".progress .progress-bar");e&&e.css("width",a+"%");b.find(".gauge")&&(b.find(".gauge").removeClass("notSeen").RadialGauge("setRotation",a),(100===a||c)&&b.find(".gauge").addClass("complete").find(".fa").attr("class",
"fa fa-check"))},selectFirst:function(){c(this.container.find(".menu li").first()).trigger("click",this.options.autoPlay)},selectLast:function(){c(this.container.find(".menu li").last()).trigger("click",!1)},setOption:function(a,b){this.options[a]=b},destroy:function(){c(window).off("resize",this.sizeVideo);this.videoInterface&&this.videoInterface.destroy();this.container.off("dkivp");this.container.data("dki.VideoPlaylist",null)},ended:function(a){a=this.container.find(".menu li.active");this.options.listeners.end.call(this);
this.completion[a.data("id")].complete=!0;this.options.autoPlay&&(a=a.next(),a[0]&&a.trigger("click"))},started:function(a){this.options.listeners.start.call(this)},timeUpdate:function(a,b){a=this.container.find(".menu li.active");a.data("completion");this.setCompletion(b.current/b.duration*100,a);this.completion[a.data("id")]=this.completion[a.data("id")]||{time:0,complete:!1};this.completion[a.data("id")].time=b.current},played:function(){var a=this.container.find(".menu li");a.find(".completion .fa").attr("class",
"fa fa-play");a.filter("[data-id\x3d'"+this.videoInterface.outline.id+"']").find(".completion .fa").attr("class","fa fa-pause");this.options.listeners.play.call(this);this.container.trigger("play")},paused:function(a){this.container.find(".menu li[data-id\x3d'"+this.videoInterface.outline.id+"'] .completion .fa").attr("class","fa fa-play");this.options.listeners.pause.call(this)},toggleMenu:function(){this.options.collapsed=!this.options.collapsed;this.container.find(".menu").css("display",this.options.collapsed?
"none":"");this.container.find(".vp-collapse.h").removeClass("fa-chevron-right fa-chevron-left").addClass("fa-chevron-"+(this.options.collapsed?"left":"right"));this.container.find(".vp-collapse.v").removeClass("fa-chevron-up fa-chevron-down").addClass("fa-chevron-"+(this.options.collapsed?"down":"up"));this.sizeVideo()},getCompletion:function(){return this.completion},initCompletion:function(){var a=this.container.find(".menu li"),b=this;c.each(this.completion,function(c,e){e=a.filter("*[data-id\x3d'"+
c+"']");(c=b.lookup[c])&&b.setCompletion(this.time/(c.parameters.config.duration||0)*100,e,this.complete)})}};c.fn.VideoPlaylist=function(a){var g=a,d=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=c(this),f=c(this).data("dki.VideoPlaylist");options=c.extend(!0,{},b.DEFAULTS,"object"===typeof g&&g);if("string"===typeof a&&!f)return!1;f?"string"===typeof a&&(e=c(this).data("dki.VideoPlaylist"))&&e[a]&&e[a].apply(c(this).data("dki.VideoPlaylist"),d):e.data("dki.VideoPlaylist",
new b(this,options))})};c.fn.VideoPlaylist.Constructor=b;var h=function(){return Error("Not Implemented")};b.videoInterface=function(){};b.videoInterface.prototype="render load destroy onReady play pause stop getTime getURL focusVideo".split(" ").reduce(function(a,b){a[b]=h;return a},{});b.videoInterface.prototype.setVideoAccessible=function(a){c(a).attr("tabindex",1).attr("aria-label",this.outline.title)};b.videoInterface.prototype.getCompletion=function(a){return this.options.playList.completion[this.outline.id]};
b.videoInterface.prototype.getTime=function(a){return this.getCompletion().time};b.youtubeVideo=function(a,b,c){this.options=DKI.applyIf(c,{listeners:{start:function(){},pause:function(){},play:function(){},end:function(){},timeUpdate:function(){}}});this.container=b.find(".vidWrapper");this.outline=a;this.isPlaying=!1;this.render();return this};b.youtubeVideo.prototype=Object.create(b.videoInterface.prototype);b.youtubeVideo.prototype.render=function(){var a=this,b="APIFrame_"+this.outline.parent_element_id;
this.container.html("\x3cdiv id\x3d'"+b+"'\x3e\x3c/div\x3e");youtubePlayerReady(function(){var c=new YT.Player(b,{height:"100%",width:"100%",playerVars:{playsinline:1,rel:0},events:{onReady:function(b){a.setVideoAccessible(c.a);a.API=c;a.container.trigger("youtubeReady")},onStateChange:function(b){YT.PlayerState.ENDED===b.data?a.ended.call(a):YT.PlayerState.PLAYING===b.data?(a.API.started||(a.started.call(a),a.API.started=!0,a.loaded()),a.playing.call(a)):YT.PlayerState.PAUSED===b.data?a.paused.call(a):
YT.PlayerState.CUED===b.data&&a.loaded()},onError:function(a){}}})})};b.youtubeVideo.prototype.onReady=function(a){this.container.on("youtubeReady",c.proxy(a,this));this.API&&a.call(this)};b.youtubeVideo.prototype.load=function(a,b,d,e){this.outline=a;this.loaded=d||function(){};this.clearTimer();this.onReady(c.proxy(function(){this.API.started=!1;(b?this.API.loadVideoById:this.API.cueVideoById).call(this.API,a.parameters.config.videoId,e?e.time/1E3:0)},this))};b.youtubeVideo.prototype.destroy=function(){if(this.API)try{this.API.destroy()}catch(a){}this.clearTimer()};
b.youtubeVideo.prototype.startTimer=function(){var a=1E3*this.API.getCurrentTime()%1E3,b=this;this.clearTimer();this.timer=setTimeout(function(){b.timeUpdated();b.interval=setInterval(function(){b.timeUpdated()},1E3)},a)};b.youtubeVideo.prototype.clearTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)};b.youtubeVideo.prototype.started=function(){this.isPlaying=!0;this.startTimer();this.options.listeners.start.call(this)};b.youtubeVideo.prototype.playing=function(){this.isPlaying=
!0;this.startTimer();this.options.listeners.play.call(this)};b.youtubeVideo.prototype.ended=function(){this.isPlaying=!1;clearInterval(this.interval);this.timeUpdated();this.options.listeners.end.call(this)};b.youtubeVideo.prototype.paused=function(){this.isPlaying=!1;clearInterval(this.interval);this.timeUpdated();this.options.listeners.pause.call(this)};b.youtubeVideo.prototype.timeUpdated=function(){this.options.listeners.timeUpdate(this,{current:Math.round(1E3*this.API.getCurrentTime())/1E3*1E3,
duration:Math.round(1E3*this.API.getDuration())/1E3*1E3})};b.youtubeVideo.prototype.getTime=function(){return 1E3*this.API.getCurrentTime()};b.youtubeVideo.prototype.getDuration=function(){return 1E3*this.API.getDuration()};b.youtubeVideo.prototype.getUrl=function(a){a(this.API.getVideoUrl())};b.youtubeVideo.prototype.play=function(){this.API&&this.API.playVideo()};b.youtubeVideo.prototype.pause=function(){this.API&&this.API.pauseVideo()};b.youtubeVideo.prototype.focusVideo=function(){this.API&&this.API.a.focus()};
b.vimeoVideo=function(a,b,c){this.options=DKI.applyIf(c,{listeners:{start:function(){},play:function(){},pause:function(){},end:function(){},timeUpdate:function(){}}});this.container=b.find(".vidWrapper");this.outline=a;this.isPlaying=!1;this.interval=this.timer=null;this.render();return this};b.vimeoVideo.prototype=Object.create(b.videoInterface.prototype);b.vimeoVideo.prototype.render=function(){var a=this,b="APIFrame_"+this.outline.parent_element_id;this.frame=c("\x3cdiv id\x3d'"+b+"' style\x3d'width:100%;height:100%;transition:opacity 100ms linear; opacity : 1'\x3e\x3c/div\x3e").appendTo(this.container);
vimeoSDKReady(function(d){d=d||Vimeo.Player;a.API=new d(c("#"+b)[0],{id:a.outline.parameters.config.videoId});a.API.on("loaded",function(){a.setVideoAccessible(a.frame);a.container.trigger("vimeoReady")});a.API.on("play",function(){a.startedOnce?a.playing.call(this):(a.startedOnce=!0,a.started.call(this))});a.API.on("pause",function(){a.paused.call(this)});a.API.on("ended",function(){a.ended.call(this)});a.API.on("timeupdate",function(b){a.options.listeners.timeUpdate(a,{current:Math.round(1E3*b.seconds),
duration:Math.round(1E3*b.duration)})});a.API.on("error",function(a){})})};b.vimeoVideo.prototype.onReady=function(a){this.container.on("vimeoReady",c.proxy(a,this));this.API&&a.call(this)};b.vimeoVideo.prototype.load=function(a,b,d,e){var f=this,h=a.parameters.config.videoId;f.outline=a;var k=Date.now();f._activeLoadToken=k;this.onReady(c.proxy(function(){f._activeLoadToken===k&&f.API.loadVideo(h).then(function(){function a(){"function"===typeof d&&d.call(f);b&&(f.isPlaying=!0,f.options.listeners.play.call(this),
f.API.play().catch(function(a){}))}f._activeLoadToken===k&&(e?f.API.setCurrentTime(e.time/1E3).then(a):a())}).catch(function(a){})}),this)};b.vimeoVideo.prototype.destroy=function(){if(this.API)try{this.API.destroy()}catch(a){}this.clearTimer()};b.vimeoVideo.prototype.startTimer=function(){function a(a){b.timeUpdated(a.seconds)}var b=this;b.clearTimer();b.API.on("timeupdate",a);b._timeUpdateHandler=a};b.vimeoVideo.prototype.clearTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null);
this.interval&&(clearInterval(this.interval),this.interval=null)};b.vimeoVideo.prototype.started=function(){this.isPlaying=!0;this.startTimer();this.options.listeners.start.call(this)};b.vimeoVideo.prototype.playing=function(){this.isPlaying=!0;this.startTimer();this.options.listeners.play.call(this)};b.vimeoVideo.prototype.paused=function(){this.isPlaying=!1;this.clearTimer();this.options.listeners.pause.call(this)};b.vimeoVideo.prototype.ended=function(){this.isPlaying=!1;this.clearTimer();this.timeUpdated();
this.options.listeners.end.call(this)};b.vimeoVideo.prototype.timeUpdated=function(){var a=this;c.when(this.API.getCurrentTime(),this.API.getDuration()).done(function(b,c){a.options.listeners.timeUpdate(a,{current:Math.round(1E3*b),duration:Math.round(1E3*c)})})};b.vimeoVideo.prototype.getTime=function(){return 1E3*this.API.getCurrentTime()};b.vimeoVideo.prototype.getDuration=function(){return 1E3*this.API.getDuration()};b.vimeoVideo.prototype.getUrl=function(a){a(this.API.getVideoUrl())};b.vimeoVideo.prototype.play=
function(){this.API&&this.API.play()};b.vimeoVideo.prototype.pause=function(){this.API&&this.API.pause()};b.vimeoVideo.prototype.focusVideo=function(){this.frame&&this.frame.focus()};b.assetVideo=function(){};b.assetVideo.prototype=Object.create(b.videoInterface.prototype)}(window.jQuery);var youtubeReadyCallback=[];
function youtubePlayerReady(c){if("undefined"===typeof YT){var b=document.createElement("script");b.src="https://www.youtube.com/iframe_api";var h=document.getElementsByTagName("script")[0];h.parentNode.insertBefore(b,h);youtubeReadyCallback.push(c)}else c()}function onYouTubeIframeAPIReady(){for(;0<youtubeReadyCallback.length;)youtubeReadyCallback.pop()()}var vimeoCallbacks=[];
function vimeoSDKReady(c){if("undefined"!==typeof requirejs)requirejs(["https://player.vimeo.com/api/player.js"],c);else if("undefined"===typeof Vimeo){var b=document.createElement("script");b.src="https://player.vimeo.com/api/player.js";var h=document.getElementsByTagName("script")[0];b.onload=function(){for(;0<vimeoCallbacks.length;)vimeoCallbacks.pop()()};h.parentNode.insertBefore(b,h);vimeoCallbacks.push(c)}else c()};